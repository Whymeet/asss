# Настройка email уведомлений в админке Битрикс

## Шаги настройки:

### 1. Проверка типа события
Перейдите в админку: **Настройки → Почтовые события → Типы почтовых событий**
Убедитесь, что существует событие `CALC_ORDER_REQUEST`

### 2. Создание почтового шаблона
Перейдите в: **Настройки → Почтовые события → Почтовые шаблоны**

Создайте новый шаблон со следующими параметрами:
- **Тип события**: CALC_ORDER_REQUEST
- **Тема письма**: Новый заказ с калькулятора - #PRODUCT_TYPE#
- **Откуда**: noreply@ваш-домен.ru
- **Кому**: ваш-email@домен.ru (email менеджера)

### 3. Тело письма (HTML):
```html
<h2>Новый заказ с калькулятора</h2>

<h3>Информация о заказе:</h3>
<ul>
    <li><strong>Продукт:</strong> #PRODUCT_TYPE#</li>
    <li><strong>Итоговая стоимость:</strong> #TOTAL_PRICE# руб.</li>
    <li><strong>Дата заказа:</strong> #ORDER_DATE#</li>
</ul>

<h3>Данные клиента:</h3>
<ul>
    <li><strong>Имя:</strong> #CLIENT_NAME#</li>
    <li><strong>Телефон:</strong> #CLIENT_PHONE#</li>
    <li><strong>Email:</strong> #CLIENT_EMAIL#</li>
</ul>

<h3>Детали заказа:</h3>
<pre style="background: #f5f5f5; padding: 15px; border: 1px solid #ddd; white-space: pre-wrap;">#ORDER_TEXT#</pre>

<hr>
<p style="color: #666; font-size: 12px;">
    Это автоматическое уведомление с сайта. 
    Пожалуйста, свяжитесь с клиентом в ближайшее время.
</p>
```

### 4. Доступные поля для шаблона:
- `#ORDER_TEXT#` - полный текст заказа с деталями
- `#CLIENT_NAME#` - имя клиента
- `#CLIENT_PHONE#` - телефон клиента
- `#CLIENT_EMAIL#` - email клиента (может быть пустым)
- `#PRODUCT_TYPE#` - тип продукта (БСО, Визитки, etc.)
- `#TOTAL_PRICE#` - итоговая цена
- `#ORDER_DATE#` - дата и время заказа

### 5. Активация шаблона
Убедитесь, что созданный шаблон:
- Активен (галочка "Активность")
- Привязан к правильному сайту
- Указаны корректные email адреса

### 6. Тестирование
После настройки можно протестировать отправку через:
- Страницу `list_test.php`
- Заполнить форму калькулятора
- Нажать "Рассчитать стоимость"
- Нажать "Заказать печать"
- Заполнить контактные данные
- Отправить заказ

### 7. Проверка логов
В случае проблем проверьте файл `calc_debug.log` в корне сайта для отладочной информации.

## Дополнительные настройки:

### Множественные получатели:
В поле "Кому" можно указать несколько email через запятую:
```
manager1@domain.ru, manager2@domain.ru
```

### Копия клиенту:
Можно создать дополнительный шаблон для отправки подтверждения клиенту, используя поле `#CLIENT_EMAIL#` в поле "Кому".
